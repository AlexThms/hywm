<?xml version="1.0" encoding="UTF-8" ?>
<!DOCTYPE mapper
        PUBLIC "-//mybatis.org//DTD Mapper 3.0//EN"
        "http://mybatis.org/dtd/mybatis-3-mapper.dtd">
<mapper namespace="com.example.hywm.mapper.OrdersMapper">

    <select id="selectOrdersPage" resultType="Orders">
        select id,number,user_id AS userId,status,address_book_id AS addressBookId ,pay_method AS payMethod,order_time AS orderTime,checkout_time AS checkTime,amount,phone,address,user_name AS userName,consignee,type from orders
        <where>
            <if test="number != null and number !='' ">
               and number = #{number}
            </if>
            <if test="beginTime != null and endTime != null ">
               and   #{beginTime} <![CDATA[ <= ]]> order_time <![CDATA[ <= ]]> #{endTime}
            </if>
            <if test="beginTime != null and endTime == null ">
               and order_time >= #{beginTime}
            </if>
            <if test="beginTime == null and endTime != null ">
                and order_time <![CDATA[ <= ]]> #{endTime}
            </if>
        </where>
        order by orderTime
    </select>

    <select id="selectOrderDetail" resultType="orderDetail">
        select id,name,image,order_id AS orderId,dish_id AS dishId,setmeal_id AS setmealId ,dish_flavor AS dishFlavor,number,amount from order_detial where order_id = #{id}
    </select>

    <update id="editOrderStatus" parameterType="string">
        update orders set status = #{status}
    </update>
</mapper>